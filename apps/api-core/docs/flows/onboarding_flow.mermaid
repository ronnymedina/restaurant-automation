flowchart TD
    A[POST /onboarding/register] --> B{Validar Email}
    B -->|Ya existe| Z[Error: Usuario duplicado]
    B -->|Nuevo| C[Crear Restaurant]
    C --> D[Crear Usuario MANAGER]
    D --> E[Enviar Email Activacion]
    E --> F[Crear Categoria 'default']
    E -->|Fallo envio| O[Log Warning - No detiene flujo]
    O --> F
    F --> G{skipProducts?}
    G -->|Si| H[Crear 3 productos demo]
    G -->|No| I{Hay fotos?}
    I -->|Si| J[Extraer productos con Gemini]
    I -->|No| K[Sin productos]
    J --> L{Gemini configrado?}
    L -->|Si| M[Procesar productos en batches]
    L -->|No| H
    M --> N[Retornar resultado]
    H --> N
    K --> N
